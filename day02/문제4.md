## ✅ 문제 분석: 온프레미스 → 배스천 → 프라이빗 EC2 접근 구성

### 🧩 문제 요약

- 프라이빗 서브넷에 애플리케이션 EC2가 존재한다.
- 퍼블릭 서브넷에 Linux 기반 배스천 호스트가 존재한다.
- 온프레미스 네트워크에서 인터넷을 통해 AWS로 접속해야 한다.
- 모든 EC2 인스턴스의 보안 그룹이 해당 접근을 허용해야 한다.
- 정답은 두 가지 선택이다.

---

## 🔎 핵심 아키텍처 이해

이 문제는 전형적인 **Bastion Host 패턴**이다.

접속 흐름은 다음과 같다.

온프레미스 → (인터넷) → 퍼블릭 서브넷의 배스천 → 프라이빗 서브넷의 애플리케이션 서버

프라이빗 서브넷은 Internet Gateway와 직접 연결되지 않기 때문에  
외부에서 직접 SSH 접속이 불가능하다.  
따라서 반드시 **배스천을 경유**해야 한다.

---

## 🛡 보안 그룹 설계 핵심

보안 설계는 다음 원칙을 따른다.

1. 배스천은 회사 네트워크에서만 접근 가능해야 한다.
2. 애플리케이션 서버는 배스천에서만 SSH 접근 가능해야 한다.
3. 프라이빗 인스턴스는 외부에서 직접 접근되면 안 된다.

---

## 🔎 선택지 분석

### ❌ 선택지 1  
배스천을 애플리케이션 인스턴스로부터만 접근 허용

이 구성은 외부(온프레미스) 접근을 고려하지 않는다.  
배스천은 외부에서 들어오는 SSH 진입점이므로  
회사 네트워크에서 접근 가능해야 한다.  
따라서 요구사항을 충족하지 못한다.

---

### ❌ 선택지 2  
배스천에 회사 내부 IP 범위만 허용

문제에서 온프레미스 네트워크는 **인터넷을 통해 접속**한다고 명시되어 있다.  
즉, 외부 공인 IP 범위에서 접근이 발생한다.  
단순 내부 사설 IP 범위 허용은 조건과 맞지 않는다.

---

### ✅ 선택지 3  
배스천에 회사의 **외부(공인) IP 범위**에서만 인바운드 허용

온프레미스에서 인터넷을 통해 접속한다는 것은  
공인 IP를 통해 SSH 접근이 발생한다는 의미다.

따라서 배스천 보안 그룹은  
회사 공인 IP 범위에서의 SSH(포트 22) 접근만 허용해야 한다.

이 구성은 최소 권한 원칙에 부합한다.

---

### ✅ 선택지 4  
애플리케이션 인스턴스는 배스천의 **사설 IP**에서만 SSH 허용

프라이빗 인스턴스는 외부에서 직접 접근되면 안 된다.  
따라서 애플리케이션 서버 보안 그룹은  
배스천의 **Private IP 또는 Security Group**에서만 접근을 허용해야 한다.

이렇게 하면 외부 → 배스천 → 내부 서버 구조가 완성된다.

---

### ❌ 선택지 5  
애플리케이션 인스턴스가 배스천의 퍼블릭 IP만 허용

퍼블릭 IP 기반 허용은 보안상 불필요하다.  
VPC 내부 통신은 사설 IP를 사용한다.  
배스천이 내부에서 접속할 때는 Private IP를 사용하므로  
퍼블릭 IP 허용은 적절하지 않다.

---

## ✅ 최종 정답

**선택지 3번 + 선택지 4번**

---

## 🧠 시험 포인트 정리

- 프라이빗 서브넷은 외부에서 직접 접근 불가
- 배스천은 퍼블릭 서브넷에 위치
- 외부 SSH는 배스천으로만 허용
- 내부 서버는 배스천에서만 접근 허용
- 내부 통신은 항상 **Private IP 기준**

---

## 🔐 상태 저장 보안 그룹 개념 정리

Security Group은 상태 저장 방식으로 동작한다.  
인바운드를 허용하면 응답 트래픽은 자동으로 허용된다.  
따라서 SSH 인바운드 규칙만 설정해도 통신이 성립한다.

---

